const i18n = (function () {
	const dictionaries = {
		EN: {
			nav_inventory: 'Inventory',
			nav_dashboard: 'Dashboard',
			nav_products: 'Products',
			nav_movements: 'Movements',
			nav_export: 'Export',
			nav_settings: 'Settings',
			nav_logout: 'Logout',
			topbar_title: 'Inventory Console',
			login_title: 'Welcome back',
			login_sub: 'Sign in to manage your inventory with confidence.',
			username_label: 'Username',
			password_label: 'Password',
			login_button: 'Sign in',
			demo_hint: 'Demo: admin / admin',
			dashboard_title: 'Overview',
			dashboard_hint: 'At-a-glance status',
			stat_products: 'Products',
			stat_stock: 'Total Stock',
			stat_movements: 'Movements',
			chart_title: 'Recent movements',
			chart_empty: 'Not enough data yet',
			inventory_status: 'Inventory status',
			inventory_status_outOfStock: 'Out of stock: {items}',
			inventory_status_lowStock: 'Low stock: {item} ({count})',
			inventory_status_outItem: 'OUT: {item} ({count})',
			inventory_status_lowItem: 'LOW: {item} ({count})',
			inventory_status_allGood: 'All products are in good condition',
			inventory_status_more: '+{count}',
			inventory_status_outLabel: 'Out of stock',
			inventory_status_lowLabel: 'Low stock',
			inventory_status_allGoodLabel: 'All good',
			dashboard_inventoryStatus: 'Inventory status',
			dashboard_outOfStock: 'Out of stock products',
			dashboard_lowStock: 'Low stock products',
			dashboard_allGood: 'All good',
			dashboard_more: '+{count} more',
			recent_movements: 'Recent movements',
			products_title: 'Products',
			products_hint: 'Create, edit, and manage products',
			product_name_label: 'Name',
			product_category_label: 'Category',
			product_price_label: 'Price',
			product_stock_label: 'Quantity',
			product_create_btn: 'Add product',
			product_update_btn: 'Save changes',
			product_reset_btn: 'Reset',
			table_header_name: 'Name',
			table_header_category: 'Category',
			table_header_price: 'Price',
			table_header_stock: 'Quantity',
			table_header_actions: 'Actions',
			table_header_date: 'Date',
			table_header_product: 'Product',
			table_header_type: 'Type',
			table_header_quantity: 'Quantity',
			no_products: 'No products yet',
			no_movements: 'No movements yet',
			movements_title: 'Movements',
			movements_hint: 'Record incoming and outgoing stock',
			movement_product_label: 'Product',
			movement_type_label: 'Type',
			movement_type_select_btn: 'Select movement type',
			movement_type_select_placeholder: 'Select movement type',
			movement_quantity_label: 'Quantity',
			movement_type_in: 'IN',
			movement_type_out: 'OUT',
			movement_submit_btn: 'Record movement',
			movement_hint_helper: 'OUT will subtract from stock',
			movements_inHint: 'Incoming will increase stock',
			movements_outHint: 'Outgoing will decrease stock',
			movement_helper_in: 'Stock IN increases warehouse quantity',
			movement_helper_out: 'Stock OUT decreases warehouse quantity',
			movement_stock_label: 'Current stock: {count}',
			movement_out_blocked: 'This product is out of stock. OUT is disabled.',
			movement_out_insufficient: 'Only {count} left in stock.',
			movement_no_product: 'Product not found',
			export_title: 'Export',
			export_hint: 'Download CSV with raw values',
			export_button: 'Export CSV',
			settings_title: 'Settings',
			settings_hint: 'Language and session',
			settings_language: 'Language',
			settings_session: 'Session',
			lang_label: 'Language',
			toast_saved: 'Saved',
			toast_deleted: 'Deleted',
			toast_error: 'Something went wrong',
			network_error: 'Network error, try again',
			action_edit: 'Edit',
			action_delete: 'Delete',
			confirm_delete: 'Delete this item?',
			movement_success: 'Movement recorded',
			deleted_product: 'Deleted product',
			products_deletedLabel: 'Deleted product',
			stock_badge_empty: 'OUT OF STOCK',
			stock_badge_low: 'LOW ({count})',
			stock_outOfStock: 'Out of stock',
			stock_lowStock: 'Low stock ({count})',
			'stock.outOfStockLabel': 'OUT OF STOCK',
			'stock.lowStockLabel': 'LOW STOCK ({count})',
		},
		UZ: {
			nav_inventory: 'Ombor',
			nav_dashboard: 'Boshqaruv',
			nav_products: 'Mahsulotlar',
			nav_movements: 'Harakatlar',
			nav_export: 'Eksport',
			nav_settings: 'Sozlamalar',
			nav_logout: 'Chiqish',
			topbar_title: 'Ombor Konsoli',
			login_title: 'Xush kelibsiz',
			login_sub: 'Ishonch bilan omborni boshqaring.',
			username_label: 'Foydalanuvchi',
			password_label: 'Parol',
			login_button: 'Kirish',
			demo_hint: 'Demo: admin / admin',
			dashboard_title: 'Umumiy holat',
			dashboard_hint: 'Qisqa ko‘rinish',
			stat_products: 'Mahsulotlar',
			stat_stock: 'Umumiy miqdor',
			stat_movements: 'Harakatlar',
			chart_title: 'So‘nggi harakatlar',
			chart_empty: 'Maʼlumot yetarli emas',
			inventory_status: 'Ombor holati',
			inventory_status_outOfStock: 'Tugagan: {items}',
			inventory_status_lowStock: 'Kam qolgan: {item} ({count})',
			inventory_status_outItem: 'TUGAGAN: {item} ({count})',
			inventory_status_lowItem: 'KAM: {item} ({count})',
			inventory_status_allGood: 'Barcha mahsulotlar ijobiy holatda',
			inventory_status_more: '+{count}',
			inventory_status_outLabel: 'Tugagan',
			inventory_status_lowLabel: 'Kam qolgan',
			inventory_status_allGoodLabel: 'Ijobiy holatda',
			dashboard_inventoryStatus: 'Ombor holati',
			dashboard_outOfStock: 'Tugagan mahsulotlar',
			dashboard_lowStock: 'Kam qolgan mahsulotlar',
			dashboard_allGood: 'Ijobiy holatda',
			dashboard_more: '+{count} ta ko‘proq',
			recent_movements: 'So‘nggi harakatlar',
			products_title: 'Mahsulotlar',
			products_hint: 'Mahsulotlarni yarating va tahrirlang',
			product_name_label: 'Nomi',
			product_category_label: 'Kategoriya',
			product_price_label: 'Narxi',
			product_stock_label: 'Miqdor',
			product_create_btn: 'Mahsulot qo‘shish',
			product_update_btn: 'O‘zgartirishlarni saqlash',
			product_reset_btn: 'Tozalash',
			table_header_name: 'Nomi',
			table_header_category: 'Kategoriya',
			table_header_price: 'Narxi',
			table_header_stock: 'Miqdor',
			table_header_actions: 'Amallar',
			table_header_date: 'Sana',
			table_header_product: 'Mahsulot',
			table_header_type: 'Turi',
			table_header_quantity: 'Miqdor',
			no_products: 'Mahsulotlar hali yo‘q',
			no_movements: 'Harakatlar hali yo‘q',
			movements_title: 'Harakatlar',
			movements_hint: 'Kirim va chiqimlarni yozib boring',
			movement_product_label: 'Mahsulot',
			movement_type_label: 'Turi',
			movement_type_select_btn: 'Harakat turini tanlang',
			movement_type_select_placeholder: 'Harakat turini tanlang',
			movement_quantity_label: 'Miqdor',
			movement_type_in: 'KIRIM',
			movement_type_out: 'CHIQIM',
			movement_submit_btn: 'Harakatni yozish',
			movement_hint_helper: 'CHIQIM ombordagi miqdorni kamaytiradi',
			movements_inHint: 'Kirim ombordagi miqdorni ko‘paytiradi',
			movements_outHint: 'Chiqim ombordagi miqdorni kamaytiradi',
			movement_helper_in: 'Kirim ombordagi miqdorni ko‘paytiradi',
			movement_helper_out: 'Chiqim ombordagi miqdorni kamaytiradi',
			movement_stock_label: 'Zaxirada: {count} dona',
			movement_out_blocked: 'Bu mahsulot tugagan. Chiqim yozib bo‘lmaydi.',
			movement_out_insufficient: 'Zaxirada faqat {count} dona bor.',
			movement_no_product: 'Mahsulot topilmadi',
			export_title: 'Eksport',
			export_hint: 'CSV formatida yuklab oling',
			export_button: 'CSV yuklab olish',
			settings_title: 'Sozlamalar',
			settings_hint: 'Til va sessiya',
			settings_language: 'Til',
			settings_session: 'Sessiya',
			lang_label: 'Til',
			toast_saved: 'Saqlangan',
			toast_deleted: 'O‘chirildi',
			toast_error: 'Xatolik yuz berdi',
			network_error: 'Tarmoq xatosi, qayta urinib ko‘ring',
			action_edit: 'Tahrirlash',
			action_delete: 'O‘chirish',
			confirm_delete: 'O‘chirishni tasdiqlaysizmi?',
			movement_success: 'Harakat yozildi',
			deleted_product: 'O‘chirilgan mahsulot',
			products_deletedLabel: 'O‘chirilgan mahsulot',
			stock_badge_empty: 'TUGAGAN',
			stock_badge_low: 'KAM QOLDI ({count})',
			stock_outOfStock: 'Mahsulot tugagan',
			stock_lowStock: 'Kam qoldi ({count})',
			'stock.outOfStockLabel': 'TUGAGAN',
			'stock.lowStockLabel': 'KAM QOLDI ({count})',
		},
		JP: {
			nav_inventory: '在庫',
			nav_dashboard: 'ダッシュボード',
			nav_products: '商品',
			nav_movements: '入出庫',
			nav_export: 'エクスポート',
			nav_settings: '設定',
			nav_logout: 'ログアウト',
			topbar_title: '在庫コンソール',
			login_title: 'お帰りなさい',
			login_sub: '在庫を安全に管理しましょう。',
			username_label: 'ユーザー名',
			password_label: 'パスワード',
			login_button: 'ログイン',
			demo_hint: 'デモ: admin / admin',
			dashboard_title: '概要',
			dashboard_hint: '現在の状態',
			stat_products: '商品数',
			stat_stock: '総数量',
			stat_movements: '入出庫',
			chart_title: '最新の入出庫',
			chart_empty: 'データが足りません',
			inventory_status: '在庫状況',
			inventory_status_outOfStock: '在庫切れ: {items}',
			inventory_status_lowStock: '残りわずか: {item} ({count})',
			inventory_status_outItem: '在庫切れ: {item} ({count})',
			inventory_status_lowItem: '残少: {item} ({count})',
			inventory_status_allGood: 'すべての商品は良好です',
			inventory_status_more: '+{count}',
			inventory_status_outLabel: '在庫切れ',
			inventory_status_lowLabel: '残りわずか',
			inventory_status_allGoodLabel: '良好な状態です',
			dashboard_inventoryStatus: '在庫状況',
			dashboard_outOfStock: '在庫切れの商品',
			dashboard_lowStock: '残りわずかの商品',
			dashboard_allGood: '良好な状態です',
			dashboard_more: 'さらに {count} 件',
			recent_movements: '最新の入出庫',
			products_title: '商品',
			products_hint: '商品を作成・編集',
			product_name_label: '名称',
			product_category_label: 'カテゴリ',
			product_price_label: '価格',
			product_stock_label: '数量',
			product_create_btn: '商品を追加',
			product_update_btn: '変更を保存',
			product_reset_btn: 'リセット',
			table_header_name: '名称',
			table_header_category: 'カテゴリ',
			table_header_price: '価格',
			table_header_stock: '数量',
			table_header_actions: '操作',
			table_header_date: '日付',
			table_header_product: '商品',
			table_header_type: '種別',
			table_header_quantity: '数量',
			no_products: '商品がありません',
			no_movements: '入出庫がありません',
			movements_title: '入出庫',
			movements_hint: '入庫と出庫を記録',
			movement_product_label: '商品',
			movement_type_label: '種別',
			movement_type_select_btn: '入出庫種別を選択',
			movement_type_select_placeholder: '入出庫種別を選択',
			movement_quantity_label: '数量',
			movement_type_in: '入庫',
			movement_type_out: '出庫',
			movement_submit_btn: '記録する',
			movement_hint_helper: '出庫は在庫を減らします',
			movements_inHint: '入庫は在庫を増やします',
			movements_outHint: '出庫は在庫を減らします',
			movement_helper_in: '入庫は在庫数を増やします',
			movement_helper_out: '出庫は在庫数を減らします',
			movement_stock_label: '現在の在庫: {count}',
			movement_out_blocked: 'この商品は在庫切れです。出庫はできません。',
			movement_out_insufficient: '在庫は残り {count} 個です。',
			movement_no_product: '商品が見つかりません',
			export_title: 'エクスポート',
			export_hint: 'CSVをダウンロード',
			export_button: 'CSVをエクスポート',
			settings_title: '設定',
			settings_hint: '言語とセッション',
			settings_language: '言語',
			settings_session: 'セッション',
			lang_label: '言語',
			toast_saved: '保存しました',
			toast_deleted: '削除しました',
			toast_error: '問題が発生しました',
			network_error: 'ネットワークエラーです',
			action_edit: '編集',
			action_delete: '削除',
			confirm_delete: '削除しますか？',
			movement_success: '記録しました',
			deleted_product: '削除された商品',
			products_deletedLabel: '削除された商品',
			stock_badge_empty: '在庫なし',
			stock_badge_low: '残りわずか ({count})',
			stock_outOfStock: '在庫切れ',
			stock_lowStock: '残りわずか ({count})',
			'stock.outOfStockLabel': '在庫切れ',
			'stock.lowStockLabel': '残りわずか ({count})',
		},
	};

	let current = localStorage.getItem('lang') || 'EN';

	function setLanguage(lang) {
		current = dictionaries[lang] ? lang : 'EN';
		localStorage.setItem('lang', current);
	}

	function t(key) {
		return dictionaries[current][key] || key;
	}

	function translateDom(root = document) {
		root.querySelectorAll('[data-i18n]').forEach((el) => {
			const key = el.getAttribute('data-i18n');
			const text = t(key);
			if (text) el.textContent = text;
		});
	}

	return { setLanguage, t, translateDom, get current() { return current; } };
})();
